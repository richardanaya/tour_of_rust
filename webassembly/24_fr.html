<!DOCTYPE html>
    <html lang="fr" dir="ltr">
    <head>
        <title>Tour de WebAssembly - Let's go on an adventure!</title>

        <meta charset="UTF-8">
        <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
        <meta content="utf-8" http-equiv="encoding">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="keywords" content="Rust, Programming, Learning">
        <meta name="description" content="Welcome to the Tour of Rust. This is meant to be a step by step guide through the features of the Rust programming language">
        <meta name="theme-color" content="#ff6801"/>

        <link rel="stylesheet" href="tour.css">
        <link rel="preload" href="https://fonts.gstatic.com/s/neuton/v12/UMBQrPtMoH62xUZKdK0vfQr4LLkw6A.woff2" as="font" />
        <link rel="preload" href="https://fonts.gstatic.com/s/neuton/v12/UMBTrPtMoH62xUZCz4g6UCj1Bg.woff2" as="font" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Neuton:ital,wght@0,400;0,700;1,400&display=swap" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:wght@400;700&display=swap" />

        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="./site.webmanifest">

        <script src="./tour.js" defer></script>
    </head>
    <body>
        <div class="tour">
            <div class="header">
                <span class="title"><a href="00_fr.html">Tour de WebAssembly</a></span>
                <span class="nav">
                <span class="toc"><a href="TOC_fr.html">Table des Matières</a></span>
            </div>
            <div class="page">
            <h1>Retourner une référence</h1>
            <p>Nous rencontrons cependant un problème avec les fonctions dynamiques
lorsque nous voulons retourner une référence à un objet. En effet,
WebAssembly et JavaScript ne peuvent échanger entre eux uniquement
des nombres! Afin de surmonter ce problème, il nous suffit d'établir
une convention pour pouvoir référencer nos objets JavaScript en
stockant ces objets dans le contexte.</p>
<pre><code class="rust language-rust">let query_selector_handle = register_function("
  (context, selectorStart, selectorEnd) =&gt; {
    let selector = context.getUtf8FromMemory(
      selectorStart,selectorEnd);
    let domEl = document.querySelector(selector);
    let objHandle = context.storeObject(domEl);
    return objHandle;
  }");

let selector = "#fancy-button";

let dom_element_handle = js_invoke_with_2_params(
    log_handle,selector.as_ptr() as f64, 
    selector.len() as f64 );
</code></pre>
            <div class="bottomnav">
                <span class="back"><a href="23_fr.html" rel="prev">❮ Précédant</a></span>
                <span class="next"><a href="25_fr.html" rel="next">Suivant ❯</a></span>
            </div>
            </div>
            <div class="code"><center><img src="/ferris_lofi.png" alt="Mascot Ferris" width="300" height="236"></center></div>
        </div>
    </body>
</html>